<div>
<img src="https://img.shields.io/badge/Domain:-Embedded%20Systems-black" align="left" width="right">
<img src="https://img.shields.io/badge/Date-8%20August%202022-green[700]" widht="25" align="right">
</div>

<div align ="center"><h1>Communication Protocols</h1></div>

### Different types of Communication Protocols:

- UART
- SPI
- I2C

#### <a href="https://www.saleae.com/">Salae Logic Analyzer</a> can be used inorder to analyze these protocols.

## UART Protocol:

- Stands for Universal Asynchronous Reception and Transmission (UART)
- A simple serial communication protocol that allows the host communicates with the auxiliary device.
- UART supports bi-directional, asynchronous and serial data transmission.
- It has two data lines, one to transmit (TX) and another to receive (RX), which are used to communicate through digital pin 0, digital pin 1.
- TX and RX are connected between two devices. (eg. USB and computer)
- UART can also handle synchronization management issues between computers and external serial devices.

### How does it work?

- It can operate between devices in 3 ways:

  - Simplex = data transmission in one direction
  - Half-duplex = data transmission in either direction but not simultaneously
  - Full-duplex = data transmission in both directions simultaneously

- Once connected, data flows from TX of the transmitting UART to RX of the receiving UART.
- As UART is an asynchronous serial transmission protocol = No clocks
- Transmitting UART converts parallel data from the master device (eg. CPU) into serial form and transmit in serial to receiving UART. It will then convert the serial data back into parallel data for the receiving device.

<div align="center">
<img src="https://www.seeedstudio.com/blog/wp-content/uploads/2019/09/1-1.jpg" width="400" >
<br></br>
</div>

- As UART has no clocks, UART adds start and stop bits that are being transferred to represent the start and end of a message.
- This helps the receiving UART know when to start and stop reading bits. When the receiving UART detects a start bit, it will read the bits at the defined BAUD rate.
- UART data transmission speed is referred to as BAUD Rate and is set to 115,200 by default (BAUD rate is based on symbol transmission rate, but is similar to bit rate).
- Both UARTs must operate at about the same baud rate. If the difference of BAUD rate is more than 10%, the timing of bits may be off and render the data unusable. The user must ensure UARTs are configured to transmit and receive from the same data packet.

### Advantages of Using UART
- Simple to operate, well documented as it is a widely used method with a lot of resources online
- No clock needed
- Parity bit to allow for error checking

### Disadvantages of Using UART
- Size of the data frame is limited to only 9 bits
- Cannot use multiple master systems and slaves
- Baud rates of each UART must be within 10% of each other to prevent data loss.
- Low data transmission speeds.

### Identying UART using Salae Logic Analyzer

<div align="center">
<img src="https://hutscape.com/assets/images/tutorials/logic-analyzer-uart-decoded-signal.png" width="400"></div>

- <a href="https://www.saleae.com/">Sale Logic Analyzer</a> is a device which is used to read the data using different protocols. 
- Async Serial is used to using USART protocol.

***

## SPI Protocol:

The serial peripheral interface (SPI) is one of the most widely used interfaces between microcontroller and peripheral ICs such as sensors, ADCs, DACs, shift registers, SRAM, and others. SPI is a synchronous, full duplex master-slave-based interface. The data from the master or the slave is synchronized on the rising or falling clock edge. Both master and slave can transmit data at the same time. The SPI interface can be either 3-wire or 4-wire. 

This article provides a brief description of the 4-wire SPI interface followed by an introduction to SPI enabled switches and muxes that help reduce the number of digital GPIOs in system board design.

### Interface:

- 4-wire SPI devices have four signals:

- Clock (SPI CLK, SCLK)
Chip select (CS)
Master out, slave in (MOSI)
Master in, slave out (MISO)
The device that generates the clock signal is called the master. Data transmitted between the master and the slave is synchronized to the clock generated by the master. SPI devices support much higher clock frequencies compared to I2C interfaces. Users should consult the product data sheet for the clock frequency specification of the SPI interface.

- SPI interfaces can have only one master and can have one or multiple slaves. Figure 1 shows the SPI connection between the master and the slave.

- The chip select signal from the master is used to select the slave. This is normally an active low signal and is pulled high to disconnect the slave from the SPI bus. When multiple slaves are used, an individual chip select signal for each slave is required from the master. In this article, the chip select signal is always an active low signal.

- MOSI and MISO are the data lines. MOSI transmits data from the master to the slave and MISO transmits data from the slave to the master.

<div align="center">
<img src="https://data.embeddedcomputing.com/uploads/articles/wp/10769/files-aHViPTYzODY3JmNtZD1pdGVtZWRpdG9yaW1hZ2UmZmlsZW5hbWU9aXRlbWVkaXRvcmltYWdlXzVlMGE0OTZlZTcyZjYuanBnJnZlcnNpb249MDAwMCZzaWc9N2E0YWQ5MmNiMDliODYwMjY0NmI2OGQzODg3Y2UwYTU253D" width="400" >
</div>

### Data Transmission:

- To begin SPI communication, the master must send the clock signal and select the slave by enabling the CS signal. Usually chip select is an active low signal; hence, the master must send a logic 0 on this signal to select the slave.

- SPI is a full-duplex interface; both master and slave can send data at the same time via the MOSI and MISO lines respectively. During SPI communication, the data is simultaneously transmitted (shifted out serially onto the MOSI/SDO bus) and received (the data on the bus (MISO/SDI) is sampled or read in). The serial clock edge synchronizes the shifting and sampling of the data. The SPI interface provides the user with flexibility to select the rising or falling edge of the clock to sample and/or shift the data (Refer to the device data sheet to determine the number of data bits transmitted using the SPI interface.).

***

## I2C Protocol:

- I2C combines the best features of SPI and UARTs. With I2C, you can connect multiple slaves to a single master (like SPI) and you can have multiple masters controlling single, or multiple slaves. This is really useful when you want to have more than one microcontroller logging data to a single memory card or displaying text to a single LCD.

Like UART communication, I2C only uses two wires to transmit data between devices:

<div align="center">
<img src="https://www.circuitbasics.com/wp-content/uploads/2016/01/Introduction-to-I2C-Single-Master-Single-Slave.png" width="400">
</div>

- **SDA (Serial Data)** – The line for the master and slave to send and receive data.

- **SCL (Serial Clock)** – The line that carries the clock signal.

- I2C is a serial communication protocol, so data is transferred bit by bit along a single wire (the SDA line).

Like SPI, I2C is synchronous, so the output of bits is synchronized to the sampling of bits by a clock signal shared between the master and the slave. The clock signal is always controlled by the master.

<div align="center">
<img src="https://www.circuitbasics.com/wp-content/uploads/2016/02/Basics-of-the-I2C-Communication-Protocol-Specifications-Table.png" width="400"></div>

### HOW I2C WORKS: 

With I2C, data is transferred in messages. Messages are broken up into frames of data. Each message has an address frame that contains the binary address of the slave, and one or more data frames that contain the data being transmitted. The message also includes start and stop conditions, read/write bits, and ACK/NACK bits between each data frame:

Introduction to I2C - Message, Frame, and Bit

- **Start Condition**: The SDA line switches from a high voltage level to a low voltage level before the SCL line switches from high to low.

- **Stop Condition**: The SDA line switches from a low voltage level to a high voltage level after the SCL line switches from low to high.

- **Address Frame**: A 7 or 10 bit sequence unique to each slave that identifies the slave when the master wants to talk to it.

- **Read/Write Bit**: A single bit specifying whether the master is sending data to the slave (low voltage level) or requesting data from it (high voltage level).

- **ACK/NACK Bit**: Each frame in a message is followed by an acknowledge/no-acknowledge bit. If an address frame or data frame was successfully received, an ACK bit is returned to the sender from the receiving device.


<div align="center"><b>***</b><div>